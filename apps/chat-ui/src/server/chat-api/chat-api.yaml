openapi: 3.0.0
paths:
  /api/chat:
    post:
      description: >-
        Create a new conversation with the AI assistant. The server will
        generate and return a conversationId that should be used for follow-up
        messages.
      operationId: ChatController_createConversation
      parameters: []
      requestBody:
        required: true
        description: New chat request containing the first message and user name
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewChatRequestDto'
            examples:
              firstMessage:
                summary: First message in a conversation
                description: Starting a new conversation with a greeting
                value:
                  message: Hello! What can you help me with?
                  user: John Doe
      responses:
        '201':
          description: Successfully created a new conversation and received a response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponseDto'
              example:
                message: >-
                  Hello John Doe! I can help you with a wide variety of tasks
                  including answering questions, providing information, helping
                  with problem-solving, and having conversations. What would you
                  like assistance with today?
                conversationId: 550e8400-e29b-41d4-a716-446655440000
        '400':
          description: Bad request - invalid input data (e.g., missing required fields)
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 400
                  message:
                    type: array
                    items:
                      type: string
                    example:
                      - message should not be empty
                      - user should not be empty
                  error:
                    type: string
                    example: Bad Request
        '500':
          description: Internal server error - failed to get response from AI
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 500
                  message:
                    type: string
                    example: 'Failed to get response from AI: Connection timeout'
      summary: Start a new conversation
      tags:
        - chat
  /api/chat/{conversationId}:
    put:
      description: >-
        Send a follow-up message to an existing conversation. Use the
        conversationId returned from the initial POST request.
      operationId: ChatController_continueConversation
      parameters:
        - name: conversationId
          required: true
          in: path
          description: UUID of the conversation to continue
          schema:
            format: uuid
            example: 550e8400-e29b-41d4-a716-446655440000
            type: string
      requestBody:
        required: true
        description: Chat request containing the message and user name
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContinueChatRequestDto'
            examples:
              followUp:
                summary: Follow-up message
                description: Continuing an existing conversation
                value:
                  message: Can you tell me more about that?
                  user: John Doe
              personalizedQuestion:
                summary: Question requiring user context
                description: >-
                  Asking a question where the assistant can use the user tool
                  for personalization
                value:
                  message: What is my name?
                  user: Alice Smith
      responses:
        '200':
          description: Successfully received a response from the assistant
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponseDto'
              example:
                message: >-
                  I'd be happy to tell you more! What specific aspect would you
                  like me to elaborate on?
                conversationId: 550e8400-e29b-41d4-a716-446655440000
        '400':
          description: >-
            Bad request - invalid input data (e.g., missing required fields,
            invalid UUID format)
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 400
                  message:
                    type: array
                    items:
                      type: string
                    example:
                      - message should not be empty
                  error:
                    type: string
                    example: Bad Request
        '500':
          description: Internal server error - failed to get response from AI
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 500
                  message:
                    type: string
                    example: 'Failed to get response from AI: Connection timeout'
      summary: Continue an existing conversation
      tags:
        - chat
    delete:
      description: Delete a conversation and its entire message history by conversationId
      operationId: ChatController_removeConversation
      parameters:
        - name: conversationId
          required: true
          in: path
          description: UUID of the conversation to remove
          schema:
            format: uuid
            example: 550e8400-e29b-41d4-a716-446655440000
            type: string
      responses:
        '200':
          description: Conversation successfully removed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Conversation removed successfully
        '400':
          description: Bad request - invalid UUID format
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 400
                  message:
                    type: array
                    items:
                      type: string
                    example:
                      - conversationId must be a UUID
                  error:
                    type: string
                    example: Bad Request
        '500':
          description: Internal server error - failed to remove conversation
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 500
                  message:
                    type: string
                    example: Failed to remove conversation
      summary: Remove a conversation
      tags:
        - chat
info:
  title: Chat API
  description: >-
    Multi-turn conversation API built with LangChain and LangGraph. This API
    maintains conversation history using LangGraph's MemorySaver, allowing for
    contextual multi-turn conversations. The assistant has access to user
    information tools for personalization.
  version: '1.0'
  contact: {}
tags:
  - name: chat
    description: Chat endpoints for conversing with the AI assistant
servers:
  - url: http://localhost:3311
    description: Development server
components:
  schemas:
    NewChatRequestDto:
      type: object
      properties:
        message:
          type: string
          description: The message from the user to start a new conversation
          example: Hello! Can you help me understand how multi-turn conversations work?
          minLength: 1
          maxLength: 5000
        user:
          type: string
          description: The name of the user sending the message. Used for personalization.
          example: Alice Johnson
          minLength: 1
          maxLength: 100
      required:
        - message
        - user
    ChatResponseDto:
      type: object
      properties:
        message:
          type: string
          description: The assistant's response message
          example: >-
            Hello Alice Johnson! I'd be happy to help you understand multi-turn
            conversations. They allow us to maintain context across multiple
            exchanges, so I can remember what we've discussed earlier in our
            conversation.
        conversationId:
          type: string
          description: The conversation ID that was used for this exchange
          example: 550e8400-e29b-41d4-a716-446655440000
          format: uuid
        confidence:
          type: number
          description: >-
            Confidence score between 0 and 1 indicating how confident the AI is
            in its answer
          example: 0.95
          minimum: 0
          maximum: 1
        hasMarkdown:
          type: boolean
          description: >-
            Indicates whether the response contains Markdown formatting, Mermaid
            diagrams, or code blocks
          example: false
      required:
        - message
        - conversationId
        - confidence
        - hasMarkdown
    ContinueChatRequestDto:
      type: object
      properties:
        message:
          type: string
          description: The message from the user to continue the conversation
          example: Can you tell me more about that?
          minLength: 1
          maxLength: 5000
        user:
          type: string
          description: The name of the user sending the message. Used for personalization.
          example: Alice Johnson
          minLength: 1
          maxLength: 100
      required:
        - message
        - user
